# vi 与 vim

## 一、基本操作

### 1. 一般命令模式

以 vi 或 vim 打开一个文件就直接进入一般命令模式了（只是默认的模式，也简称一般模式）。

一般模式可以使用 [上下左右] 按键来移动光标，可以使用 [删除字符] 或 [删除整行] 来处理文件内容，也可以使用 [复制、粘贴] 来处理文件内容

### 2. 编辑模式

在一般命令行模式之中，按下 i、o、a 等字符就可以进入编辑模式，如果要回到一般命令行模式时，则需要按下 [Esc] 按键即可退出编辑模式回到一般命令行模式。

### 3. 命令行模式

在一般模式中，输入 [: / ?] 三个中的任何一个按钮，就可以将光标移动到最下面的一行。

命令行模式当中，可以提供 [查询数据] 的操作，也可以读取、保存、批量替换字符、退出 vi 等。



## 二、操作说明

### 1. 一般命令模式

#### 1.1 移动光标的方法

| 操作          | 说明                 |
| ------------- | -------------------- |
| h或向左箭头键 | 光标向左移动一个字符 |
| j或向下箭头键 | 光标向下移动一个字符 |
| k或向上箭头键 | 光标向上移动一个字符 |
| l或向右箭头键 | 光标向右移动一个字符 |

> 如果想要进行多次移动的话，例如向下移动30行，可以使用 "30j" 或 "30【向下箭头键】" 的组合按键，亦即加上想要进行的次数(数字)后，按下操作即可。

| 操作             | 说明                                                         |
| :--------------- | :----------------------------------------------------------- |
| [Ctrl] + [f]     | 屏幕【向下】移动一页，相当于 [Page Down]按键                 |
| Ctrl] + [b]      | 屏幕【向上】移动一页，相当于 [Page Up]按键                   |
| Ctrl] + [d]      | 屏幕【向上】移动半页                                         |
| Ctrl] + [u]      | 屏幕【向下】移动半页                                         |
| +                | 光标移动到非空格符的下一行                                   |
| -                | 光标移动到非空格符的上一行                                   |
| n\<space\>       | n 表示【数字】，例如按下数字后再按空格键，光标会向右移动这一行的 n 个字符。 |
| 0 或功能键[Home] | 这是数字【0】,移动到这一行的最前面字符处。                   |
| \$ 或功能键[End] | 移动到这一行的最后面的字符                                   |
| G                | 移动到这个文件的最后一行                                     |
| nG               | n 为数字，移动到这个文件的第 n 行                            |
| gg               | 移动到这个文件的第一行，相当于1G                             |
| n \<Enter\>      | n 为数字，光标向下移动 n 行                                  |
| (、)             | 移动到上一句和下一句                                         |
| {、}             | 移动到上一段和下一段                                         |

#### 1.2 查找与替换

| 操作                   | 说明                                                         |
| ---------------------- | ------------------------------------------------------------ |
| /word                  | 向光标之下寻找一个名词为word 的字符串。                      |
| ?word                  | 向光标之上寻找一个字符串名称为 word 的字符串                 |
| n                      | n 是英文按键，代表【重复前一个查找的操作】                   |
| N                      | N 是英文按键，与 n 相反，为【反向】进行前一个查找操作        |
| :n1, n2s/word1/word2/g | n1 与 n2 为数字，在第 n1 与 n2 行之间寻找 word1 这个字符，并将该字符<br>并将该字符串替换为 word2。 |
| :1,\$s/word1/word2/g   | 从第一行到最后一行寻找 word1 字符串，并将该字符串替换为 world2 |
| :1,\$s/word1/word2/gc  | 从第一行到最后一行寻找 word1 字符串，并将该字符串替换为 word2，且在<br>替换前显示提示字符串给用户确认 (confirm) 是否需要替换 |

#### 1.3 删除、复制与粘贴

| 操作       | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| x与X       | 在一行中，x 为向后删除一个字符串(相当于[del]键)<br>X 为向后删除一个字符串（相当于 [Backspace] 即退格键） |
| nx         | n 为数字，连续向后删除 n 个字符。                            |
| dd         | 删除(剪切) 光标所在的那一整行。                              |
| ndd        | n 为数字，删除(剪切)光标所在的向下 n 行。                    |
| d1G        | 删除(剪切)光标所在到第一行的所有数据                         |
| dG         | 删除(剪切)光标所在到最后一行的所有数据                       |
| d$         | 删除(剪切)光标所在处，到该行的最后一个字符                   |
| d0         | 那是数字0，删除(剪切)光标所在处，到该行的最前面的一个字符    |
| yy         | 复制光标所在的那一行                                         |
| nyy        | n 为数字，复制光标所在的向下 n 行                            |
| y1G        | 复制光标所在行到第一行的所有数据                             |
| yG         | 复制光标所在行到最后一行的所有数据                           |
| y0         | 复制光标所在的那个字符到该行行首的所有数据                   |
| y$         | 复制光标所有的那个字符到该行行尾的所有数据                   |
| p与P       | p 为将已复制的数据在光标下一行粘贴<br>P 为将已复制的数据在光标上一行粘贴。 |
| J          | 将光标所在行与下一行的数据结合成同一行                       |
| c          | 重复删除多个数据。例如向下删除 10 行, [10cj]                 |
| u          | 恢复前一个操作                                               |
| [Ctrl] + r | 重做上一个操作                                               |
| .          | 这个符号是小数点，意思是重复前一个操作的意思                 |

### 2. 一般命令模式切换到编辑模式

#### 2.1 进入插入或替换的编辑模式

| 操作   | 说明                                                         |
| ------ | ------------------------------------------------------------ |
| i 与 I | 进入插入模式[Insert mode]<br>i 为【从目前光标处插入】<br>I 为【在目前所在行的第一个非空格处开始插入】 |
| a 与 A | 进入插入模式[Insert mode]<br>a 为【从目前光标所在的下一个字符处开始插入】<br>A 为【从光标所在行的最后一个字符处开始插入】 |
| o 与 O | 进入插入模式[Insert mode]<br>o 为【目前光标所在的下一行插入新的一行】，小写 o 字母<br>O 为【目前光标所在的上一行插入新的一行】 |
| r 与 R | 进入替换模式 (Replace mode)<br>r 只会替换光标所在的那一个字符一次<br>R 会一直替换光标所在的文字，直到按下[Esc] 键为止 |
| [Esc]  | 退出编辑模式，回到一般命令模式                               |

### 3. 一般命令模式切换到命令行模式

#### 3.1 命令行模式保存，退出等命令

| 操作                | 说明                                                         |
| ------------------- | ------------------------------------------------------------ |
| :w                  | 将编辑的数据写入硬盘文件中                                   |
| :w!                 | 若文件属性为【只读】时，强制写入该文件。                     |
| :q                  | 退出 vi 或 vim                                               |
| :q!                 | 若曾修改过文件，又不想保存，使用 ! 为强制退出不保存          |
| :wq                 | 保存后退出，若为 :wq! 则为强制保存后退出                     |
| ZZ                  | 这里是大写的 Z， 若文件没有修改，则不保存退出<br>若文件已经被修改过，则保存退出 |
| :w[filename]        | 将编辑的数据保存成另一个文件                                 |
| :r[filename]        | 在编辑的数据中，读入另一个文件的数据，亦即将[filename] 这个文件内容<br>添加到光标所在行后面 |
| :n1, n2 w[filename] | 将 n1 到 n2 的内容保存为 filename 这个文件                   |
| :!command           | 暂时退出 vi 到命令行模式下执行 command 的显示结果            |

#### 3.2 vim 环境修改

| 操作      | 说明                       |
| --------- | -------------------------- |
| :set nu   | 显示行号                   |
| :set nonu | 与 set nu 相反，为取消行号 |

## 三、VIM 可视区块

### 1. 可视区块的按键意义

| 按键       | 意义                                 |
| ---------- | ------------------------------------ |
| v          | 字符选择，会将光标经过的地方反白选择 |
| V          | 行选择，会将光标经过的行反白选择     |
| [Ctrl] + v | 可视区块， 可以用矩形的方式选择数据  |
| y          | 将反白的地方复制起来                 |
| d          | 将反白的地方删除掉                   |
| p          | 将刚刚复制的区块，在光标所在处粘贴   |

## 四、VIM 环境设置

vim 环境设置文件: `~/.vimrc` 

vim 记录操作文件: `~/.viminfo`

### 1. vim 环境设置参数

| 参数                                                      | 说明                                                         |
| --------------------------------------------------------- | ------------------------------------------------------------ |
| :set nu<br>:set nonu                                      | 设置与取消行号                                               |
| :set hlsearch<br>:set nohlsearch                          | hlsearch 就是 high light search (高亮度查找)<br>设置是否将查找的字符反白的设置，默认值是 hlsearch |
| :set autoindent<br>:set noautoindent                      | 是否自动缩进， autoindent 就是自动缩进                       |
| :set backup                                               | 是否自动保存备份文件，一般是 nobackup                        |
| :set ruler                                                | 是否显示右下角的一些状态栏说明                               |
| :set showmode                                             | 是否要显示 --INSERT-- 之类的眼在左下角的状态栏               |
| :set                                                      | 显示与系统默认值不同的设置参数，一般来说就是你自行变动过的参数 |
| :set all                                                  | 显示目前所有的环境参数设置值                                 |
| :syntax on <br>:syntax off                                | 是否根据程序语法显示不同颜色                                 |
| :set bg = dark<br>:set bg = light                         | 可用显示不同的颜色色调，默认是 [light]                       |
| :set tabstop=4<br>:set softtabstop=4<br>:set shiftwidth=4 | 自动缩进4个字符                                              |
